---
layout: article
title:  "linux下vim自动在c文件插入文件头"
tags: linux vim
categories: 代码块
date: 2017-01-05 15:05:00
---
<div id='preview-contents' class='note-content'>
                        
                    



<h3 id="linux下vim自动在c文件插入文件头">linux下vim自动在c文件插入文件头</h3>

<p>我们希望在新建c文件时，自动在文件头部加入一些代码，比如预处理命令，和编码设置。并且可以在每次修改后记录修改时间，可以将以下配置放到<code>/etc/vimrc</code>或者 <code>~/.vimrc</code> 文件底部，然后退出vim在进入vim即可生效。</p>

<pre class="prettyprint hljs-dark"><code class="language-vim hljs"><span class="hljs-string">""</span>新建.<span class="hljs-keyword">c</span>,.h,.<span class="hljs-keyword">sh</span>,.java文件，自动插入<br><span class="hljs-keyword">autocmd</span> BufNewFile *.cpp,*.[ch],*.<span class="hljs-keyword">sh</span>,*.java exec <span class="hljs-string">":call SetTitle()"</span><br><span class="hljs-keyword">autocmd</span> BufWrite *.[ch] <span class="hljs-keyword">call</span> SetLastModifiedTime(-<span class="hljs-number">1</span>)<br><span class="hljs-string">""</span><span class="hljs-comment">"定义函数SetTitle，自动插入文件头</span><br>func SetTitle()<br><span class="hljs-comment">"如果文件类型为.sh文件</span><br><span class="hljs-keyword">if</span> &amp;<span class="hljs-keyword">filetype</span> == <span class="hljs-string">'sh'</span><br><span class="hljs-keyword">call</span> <span class="hljs-built_in">setline</span>(<span class="hljs-number">1</span>,<span class="hljs-string">"#########################################################################"</span>)<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>), <span class="hljs-string">"# File Name: "</span>.<span class="hljs-built_in">expand</span>(<span class="hljs-string">"%"</span>))<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">1</span>, <span class="hljs-string">"# Author: pengzhen"</span>)<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">2</span>, <span class="hljs-string">"# mail: pz9042@163.com"</span>)<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">3</span>, <span class="hljs-string">"#Created Time:"</span>.<span class="hljs-built_in">strftime</span>(<span class="hljs-string">"%c"</span>))<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">4</span>,<br>#########################################################################<span class="hljs-comment">")</span><br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">5</span>,<span class="hljs-string">"#!/bin/bash"</span>)<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">6</span>,<span class="hljs-string">""</span>)<br><span class="hljs-keyword">else</span><br><span class="hljs-keyword">call</span> <span class="hljs-built_in">setline</span>(<span class="hljs-number">1</span>, <span class="hljs-string">"/*************************************************************************"</span>)<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>), <span class="hljs-string">" &gt; File Name: "</span>.<span class="hljs-built_in">expand</span>(<span class="hljs-string">"%"</span>))<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">1</span>, <span class="hljs-string">" &gt; Author: pengzhen"</span>)<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">2</span>, <span class="hljs-string">" &gt; Mail: pz9042@163.com "</span>)<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">3</span>, <span class="hljs-string">" &gt; Created Time: "</span>.<span class="hljs-built_in">strftime</span>(<span class="hljs-string">"%c"</span>))<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">4</span>, <span class="hljs-string">" &gt; Last Modified Time: "</span>.<span class="hljs-built_in">strftime</span>(<span class="hljs-string">"%c"</span>))<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">5</span>, <span class="hljs-string">" ************************************************************************/"</span>)<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">6</span>, <span class="hljs-string">""</span>)<br><span class="hljs-keyword">endif</span><br><span class="hljs-keyword">if</span> &amp;<span class="hljs-keyword">filetype</span> == <span class="hljs-string">'cpp'</span><br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">7</span>, <span class="hljs-string">"#include&lt;iostream&gt;"</span>)<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">8</span>, <span class="hljs-string">"using namespace std;"</span>)<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">9</span>, <span class="hljs-string">""</span>)<br><span class="hljs-keyword">endif</span><br><span class="hljs-keyword">if</span> &amp;<span class="hljs-keyword">filetype</span> == <span class="hljs-string">'c'</span><br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">7</span>, <span class="hljs-string">"#include&lt;stdio.h&gt;"</span>)<br><span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-built_in">line</span>(<span class="hljs-string">"."</span>)+<span class="hljs-number">8</span>, <span class="hljs-string">""</span>)<br><span class="hljs-keyword">endif</span><br><span class="hljs-comment">"新建文件后，自动定位到文件末尾</span><br><span class="hljs-keyword">autocmd</span> BufNewFile * <span class="hljs-keyword">normal</span> G<br>endfunc<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SetLastModifiedTime</span><span class="hljs-params">(lineno)</span></span><br> <span class="hljs-keyword">let</span> modif_time = <span class="hljs-built_in">strftime</span>( <span class="hljs-string">'%c'</span>, <span class="hljs-built_in">getftime</span>(<span class="hljs-built_in">bufname</span>(<span class="hljs-string">'%'</span>)) )<br> <span class="hljs-keyword">if</span> <span class="hljs-variable">a:lineno</span> == <span class="hljs-string">"-1"</span><br> <span class="hljs-keyword">let</span> <span class="hljs-built_in">line</span> = <span class="hljs-built_in">getline</span>(<span class="hljs-number">6</span>)<br> <span class="hljs-keyword">else</span><br> <span class="hljs-keyword">let</span> <span class="hljs-built_in">line</span> = <span class="hljs-built_in">getline</span>(<span class="hljs-variable">a:lineno</span>)<br> <span class="hljs-keyword">endif</span><br> <span class="hljs-keyword">if</span> <span class="hljs-built_in">line</span> =~ <span class="hljs-string">'^sLast Modified'</span><br> <span class="hljs-keyword">let</span> <span class="hljs-built_in">line</span> = <span class="hljs-string">' &gt; Last Modified : '</span>.modif_time<br> <span class="hljs-keyword">else</span><br> <span class="hljs-keyword">let</span> <span class="hljs-built_in">line</span> = <span class="hljs-string">' &gt; Last Modified : '</span>.modif_time<br> <span class="hljs-keyword">endif</span><br> <span class="hljs-keyword">if</span> <span class="hljs-variable">a:lineno</span> == <span class="hljs-string">"-1"</span><br> <span class="hljs-keyword">call</span> <span class="hljs-built_in">setline</span>(<span class="hljs-number">6</span>, <span class="hljs-built_in">line</span>)<br> <span class="hljs-keyword">else</span><br> <span class="hljs-keyword">call</span> <span class="hljs-keyword">append</span>(<span class="hljs-variable">a:lineno</span>, <span class="hljs-built_in">line</span>)<br> <span class="hljs-keyword">endif</span><br>endfunc<br></code></pre></div></body></html>