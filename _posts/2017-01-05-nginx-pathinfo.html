---
layout: article
title:  "wordpress在nginx下固定链接配置"
tags: pathinfo nginx
categories: php
date: 2017-01-05 15:00:00
---
<div id='preview-contents' class='note-content'>
                        
                    



<h3 id="wordpress在nginx下固定链接配置">wordpress在nginx下固定链接配置</h3>



<pre class="prettyprint hljs-dark"><code class="language-nginx hljs"><span class="hljs-attribute">user</span> nobody;<br><span class="hljs-attribute">worker_processes</span> <span class="hljs-number">1</span>;<br><br><span class="hljs-attribute">error_log</span> logs/error.log;<br><span class="hljs-comment">#error_log logs/error.log notice;</span><br><span class="hljs-comment">#error_log logs/error.log info;</span><br><br><span class="hljs-comment">#pid logs/nginx.pid;</span><br><br><span class="hljs-section">events</span> {<br>  <span class="hljs-attribute">worker_connections</span> <span class="hljs-number">1024</span>;<br>}<br><br><span class="hljs-section">http</span> {<br>  <span class="hljs-attribute">include</span> mime.types;<br>  <span class="hljs-attribute">default_type</span> application/octet-stream;<br><br>  <span class="hljs-comment">#log_format main '$remote_addr - $remote_user [$time_local] "$request" '</span><br>  <span class="hljs-comment"># '$status $body_bytes_sent "$http_referer" '</span><br>  <span class="hljs-comment"># '"$http_user_agent" "$http_x_forwarded_for"';</span><br><br>  <span class="hljs-comment">#access_log logs/access.log main;</span><br><br>  <span class="hljs-attribute">sendfile</span> <span class="hljs-literal">on</span>;<br>  <span class="hljs-comment">#tcp_nopush on;</span><br><br>  <span class="hljs-comment">#keepalive_timeout 0;</span><br>  <span class="hljs-attribute">keepalive_timeout</span> <span class="hljs-number">65</span>;<br><br>  <span class="hljs-comment">#gzip on;</span><br><br>  <span class="hljs-section">server</span> {<br>  <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;<br>  <span class="hljs-attribute">server_name</span> localhost ddzj.<span class="hljs-literal">info</span> www.ddzj.<span class="hljs-literal">info</span>;<br><br>  <span class="hljs-comment">#charset koi8-r;</span><br><br>  <span class="hljs-comment">#access_log logs/host.access.log main;</span><br><br>  <span class="hljs-attribute">location</span> / {<br>      <span class="hljs-attribute">root</span> /var/www/html/wordpress;<br>      <span class="hljs-attribute">index</span> index.php index.html index.htm;<br>      if(!-<span class="hljs-attribute">e</span> <span class="hljs-variable">$request_filename</span>){<br>            <span class="hljs-comment">#地址作为将参数rewrite到index.php上。</span><br>            <span class="hljs-attribute">rewrite</span><span class="hljs-regexp"> ^/(.*)$</span> /index.php/<span class="hljs-variable">$1</span> <span class="hljs-literal">last</span>;<br>            break;<br>        }<br><br>  }<br><br>  <span class="hljs-comment">#error_page 404 /404.html;</span><br><br>  <span class="hljs-comment"># redirect server error pages to the static page /50x.html</span><br>  <span class="hljs-comment">#</span><br>  <span class="hljs-attribute">error_page</span> <span class="hljs-number">500</span> <span class="hljs-number">502</span> <span class="hljs-number">503</span> <span class="hljs-number">504</span> /50x.html;<br>  <span class="hljs-attribute">location</span> = /50x.html {<br>  <span class="hljs-attribute">root</span> html;<br>  }<br><br>  <span class="hljs-comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br>  <span class="hljs-comment">#</span><br>  <span class="hljs-comment">#location ~ .php$ {</span><br>  <span class="hljs-comment"># proxy_pass http://127.0.0.1;</span><br>  <span class="hljs-comment">#}</span><br><br>  <span class="hljs-comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br>  <span class="hljs-comment">#</span><br><br><span class="hljs-attribute">location</span> <span class="hljs-regexp">~ .php/?.*$</span> {<br><br><span class="hljs-attribute">fastcgi_pass</span> <span class="hljs-number">127.0.0.1:9000</span>;<br>  <span class="hljs-attribute">root</span> /var/www/html/wordpress;<br>  <span class="hljs-attribute">fastcgi_index</span> index.php;<br><span class="hljs-comment">#fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><br>  <span class="hljs-attribute">include</span> fastcgi_params;<br><span class="hljs-attribute">set</span> <span class="hljs-variable">$path_info</span> <span class="hljs-string">""</span>;<br><span class="hljs-comment">#定义变量 $real_script_name，用于存放真实地址</span><br><span class="hljs-attribute">set</span> <span class="hljs-variable">$real_script_name</span> <span class="hljs-variable">$fastcgi_script_name</span>;<br><span class="hljs-comment">#如果地址与引号内的正则表达式匹配</span><br><span class="hljs-attribute">if</span> (<span class="hljs-variable">$fastcgi_script_name</span> <span class="hljs-regexp">~ "^(.+?.php)(/.+)$")</span> {<br><span class="hljs-comment">#将文件地址赋值给变量 $real_script_name</span><br><span class="hljs-attribute">set</span> <span class="hljs-variable">$real_script_name</span> <span class="hljs-variable">$1</span>;<br><span class="hljs-comment">#将文件地址后的参数赋值给变量 $path_info</span><br><span class="hljs-attribute">set</span> <span class="hljs-variable">$path_info</span> <span class="hljs-variable">$2</span>;<br>}<br><span class="hljs-comment">#配置fastcgi的一些参数</span><br><span class="hljs-attribute">fastcgi_param</span> SCRIPT_FILENAME <span class="hljs-variable">$document_root</span><span class="hljs-variable">$real_script_name</span>;<br><span class="hljs-attribute">fastcgi_param</span> SCRIPT_NAME <span class="hljs-variable">$real_script_name</span>;<br><span class="hljs-attribute">fastcgi_param</span> PATH_INFO <span class="hljs-variable">$path_info</span>;<br>}<br><br>  <span class="hljs-comment"># deny access to .htaccess files, if Apache's document root</span><br>  <span class="hljs-comment"># concurs with nginx's one</span><br>  <span class="hljs-comment">#</span><br>  <span class="hljs-comment">#location ~ /.ht {</span><br>  <span class="hljs-comment"># deny all;</span><br>  <span class="hljs-comment">#}</span><br>  }<br><br>  <span class="hljs-comment"># another virtual host using mix of IP-, name-, and port-based configuration</span><br>  <span class="hljs-comment">#</span><br>  <span class="hljs-comment">#server {</span><br>  <span class="hljs-comment"># listen 8000;</span><br>  <span class="hljs-comment"># listen somename:8080;</span><br>  <span class="hljs-comment"># server_name somename alias another.alias;</span><br><br>  <span class="hljs-comment"># location / {</span><br>  <span class="hljs-comment"># root html;</span><br>  <span class="hljs-comment"># index index.html index.htm;</span><br>  <span class="hljs-comment"># }</span><br>  <span class="hljs-comment">#}</span><br><br>  <span class="hljs-comment"># HTTPS server</span><br>  <span class="hljs-comment">#</span><br>  <span class="hljs-comment">#server {</span><br>  <span class="hljs-comment"># listen 443 ssl;</span><br>  <span class="hljs-comment"># server_name localhost;</span><br><br>  <span class="hljs-comment"># ssl_certificate cert.pem;</span><br>  <span class="hljs-comment"># ssl_certificate_key cert.key;</span><br><br>  <span class="hljs-comment"># ssl_session_cache shared:SSL:1m;</span><br>  <span class="hljs-comment"># ssl_session_timeout 5m;</span><br><br>  <span class="hljs-comment"># ssl_ciphers HIGH:!aNULL:!MD5;</span><br>  <span class="hljs-comment"># ssl_prefer_server_ciphers on;</span><br><br>  <span class="hljs-comment"># location / {</span><br>  <span class="hljs-comment"># root html;</span><br>  <span class="hljs-comment"># index index.html index.htm;</span><br>  <span class="hljs-comment"># }</span><br>  <span class="hljs-comment">#}</span><br><br>}<br></code></pre></div></body></html>