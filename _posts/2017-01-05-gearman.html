---
layout: article
title:  "gearman安装"
tags: gearma
categories: 拓展
date: 2017-01-05 14:52:00
---
<div id='preview-contents' class='note-content'>
                        
                    



<h3 id="gearman安装">gearman安装</h3>

<p>gearman是一个任务分发器，作为一个中间层，client将任务分发给gearman，gearman在分配给worker，这样就可以通过设置多个worker来减轻client的压力。<a href="http://gearman.org/" target="_blank">gearman官网</a>有非常详细的文档和安装过程。这里先介绍gearman的安装和php扩展的安装，当然gearmman是跨语言的。这里仅以php举例。 <br>
首先安装gearman的server,注意gearman依赖boost、gperf、uuid扩展,整个过程可能有点长。</p>

<pre class="prettyprint hljs-dark"><code class="language-bash hljs">pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/src$ sudo wget https://launchpad.net/gearmand/1.2/1.1.12/+download/gearmand-1.1.12.tar.gz<br>pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/src$ sudo tar zxv gearmand-1.1.12.tar.gz<br>pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/src$ <span class="hljs-built_in">cd</span> gearmand-1.1.12/<br>pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/src/gearmand-1.1.12$ sudo apt-get install libboost-all-dev<br>pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/src/gearmand-1.1.12$ sudo apt-get install uuid-dev<br>pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/src/gearmand-1.1.12$ sudo apt-get install gperf<br>pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/src/gearmand-1.1.12$ sudo ./configure --prefix=/usr/<span class="hljs-built_in">local</span>/gearman<br>pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/src/gearmand-1.1.12$ sudo make &amp;&amp; sudo make install<br>pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/gearman$ <span class="hljs-built_in">cd</span> /usr/<span class="hljs-built_in">local</span>/gearman/<br></code></pre>

<p>gearman下sbin/gearmand 是server，bin/gearman 是客户端命令，我们可以通过gearman就可以直接测试gearman的分发功能，首先启动服务</p>



<pre class="prettyprint hljs-dark"><code class="language-bash hljs">pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/gearman$ mkdir var/<span class="hljs-built_in">log</span><br>pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/gearman$ sudo sbin/gearmand <span class="hljs-_">-d</span> //启动服务<br>pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/gearman$ sudo gearman -w <span class="hljs-_">-f</span> wc -- wc <span class="hljs-_">-l</span> //启动worker，并注册wc方法，wc方法的内容是wc <span class="hljs-_">-l</span> 这个命令，-w是指启动进程为worker，<span class="hljs-_">-f</span> 指定函数<br>pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/gearman$ sudo bin/gearman <span class="hljs-_">-f</span> wc &lt;/etc/resolv.conf //启动client，并调用wc方法，传输内容为 /etc/resolv.conf文件中的内容<br>5<br>pengzhen@pengzhen-ubuntu:/usr/<span class="hljs-built_in">local</span>/gearman$ cat /etc/resolv.conf<br><span class="hljs-comment"># Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)</span><br><span class="hljs-comment">#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN</span><br>nameserver 202.96.134.133<br>nameserver 202.96.128.68<br>nameserver 127.0.1.1<br></code></pre></div></body></html>